
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>每日會議紀錄（Agenda / Action）</title>
  <style>
    :root{
      --bg:#f7f8fa;
      --panel:#ffffff;
      --text:#1f2937;
      --muted:#6b7280;
      --primary:#2563eb;
      --primary-weak:#dbeafe;
      --border:#e5e7eb;
      --success:#16a34a;
      --danger:#ef4444;
      --warn:#f59e0b;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", "Microsoft JhengHei", Roboto, "Helvetica Neue", Arial;
      background:var(--bg);
      color:var(--text);
    }
    header{
      position:sticky; top:0; z-index:10;
      background:var(--panel); border-bottom:1px solid var(--border);
      padding:12px 16px; display:flex; align-items:center; gap:12px; flex-wrap:wrap;
    }
    header h1{font-size:18px; margin:0 12px 0 0;}
    .date-controls{display:flex; gap:8px; align-items:center; flex-wrap:wrap;}
    .date-controls input[type="date"]{
      padding:6px 8px; border:1px solid var(--border); border-radius:8px; background:white;
    }
    .btn{
      padding:8px 12px; border-radius:8px; border:1px solid var(--border);
      background:white; cursor:pointer; color:var(--text);
    }
    .btn.primary{background:var(--primary); color:white; border-color:var(--primary);}
    .btn.ghost{background:transparent;}
    .btn.success{background:var(--success); color:white; border-color:var(--success);}
    .btn.warn{background:var(--warn); color:white; border-color:var(--warn);}
    .btn.danger{background:var(--danger); color:white; border-color:var(--danger);}
    .btn:disabled{opacity:.5; cursor:not-allowed}
    .layout{display:grid; grid-template-columns: 1fr 280px; gap:12px; padding:12px; align-items:start;}
    aside{
      position:sticky; top:64px;
      background:var(--panel); border:1px solid var(--border); border-radius:10px; padding:10px; max-height: calc(100vh - 80px); overflow:auto;
    }
    .panel{
      background:var(--panel); border:1px solid var(--border); border-radius:10px; padding:12px;
    }
    .columns{display:grid; grid-template-columns: 1fr 1fr; gap:12px;}
    .section-title{display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;}
    .section-title h2{font-size:16px; margin:0;}
    .toolbar{display:flex; gap:6px; flex-wrap:wrap;}
    .content-editable{
      border:1px dashed var(--border); border-radius:8px; min-height:180px; padding:10px; background:#fff;
    }
    .content-editable:focus{outline:2px solid var(--primary-weak); border-color:var(--primary);}
    .content-editable img{max-width:100%; height:auto; border-radius:6px;}
    table{width:100%; border-collapse:collapse; background:white; border:1px solid var(--border); border-radius:8px; overflow:hidden;}
    th,td{border-bottom:1px solid var(--border); padding:8px; text-align:left; vertical-align:top;}
    th{background:#f9fafb; font-weight:600; font-size:13px;}
    tr:last-child td{border-bottom:none;}
    td input[type="text"], td input[type="date"], td select{
      width:100%; padding:6px 8px; border:1px solid var(--border); border-radius:6px; background:white;
    }
    .status-pill{
      display:inline-block; padding:2px 8px; border-radius:999px; font-size:12px;
      background:#f3f4f6; color:#374151; border:1px solid var(--border);
    }
    .status-open{background:#fee2e2; color:#991b1b; border-color:#fecaca;}
    .status-done{background:#dcfce7; color:#065f46; border-color:#bbf7d0;}
    .right-list h3{margin:8px 0 4px; font-size:13px; color:#111827;}
    .right-list details{border-radius:6px; margin:2px 0;}
    .right-list summary{cursor:pointer; padding:6px 8px; border-radius:6px; color:#111827;}
    .right-list ul{list-style:none; padding:0 0 0 16px; margin:0 0 6px 0;}
    .right-list li{display:flex; justify-content:space-between; gap:6px; align-items:center; padding:4px 2px;}
    .right-list li .link{color:var(--primary); cursor:pointer; text-decoration:none;}
    .right-list li .del{color:#b91c1c; cursor:pointer; font-size:12px;}
    .muted{color:var(--muted); font-size:12px;}
    .chip{display:inline-flex; align-items:center; gap:6px; background:#eef2ff; color:#3730a3; border:1px solid #e0e7ff; border-radius:999px; padding:4px 8px; font-size:12px;}
    .stack{display:flex; gap:8px; flex-wrap:wrap; align-items:center;}
    .footer-note{font-size:12px; color:var(--muted); margin-top:6px;}
    .open-actions{margin-top:12px;}
    @media (max-width: 980px){
      .layout{grid-template-columns: 1fr;}
      aside{position:static; max-height:none; order:3;}
      .columns{grid-template-columns: 1fr;}
    }
    .hint{font-size:12px; color:var(--muted); margin:6px 0 -4px;}
    .kbd{border:1px solid var(--border); background:#f9fafb; padding:2px 6px; border-radius:4px; font-family:ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px;}
  </style>
</head>
<body>
  <header>
    <h1>每日會議紀錄</h1>
    <div class="date-controls">
      <label for="dayPicker" class="muted">日期</label>
      <input type="date" id="dayPicker" />
      <button class="btn" id="btnNewDay">新增此日期分頁</button>
      <button class="btn ghost" id="btnToday">跳到今天</button>
    </div>
    <div class="stack" style="margin-left:auto">
      <span class="chip" id="statChip">未儲存變更</span>
      <button class="btn" id="btnExportMD" title="複製 Markdown">複製 Markdown</button>
      <button class="btn primary" id="btnExportHTML" title="複製 HTML 可直接貼 Outlook">複製 HTML</button>
    </div>
  </header>

  <div class="layout">
    <main class="panel">
      <div class="columns">
        <!-- Agenda -->
        <section>
          <div class="section-title">
            <h2>Agenda</h2>
            <div class="toolbar">
              <button class="btn" id="btnAgendaClear">清空</button>
