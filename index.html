<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Meeting Minutes Tool</title>
<script src="https://cdn.tailwindcss.com"></script>
<style>

        .editable-area { min-height: 200px; border: 1px solid #e5e7eb; padding: 15px; border-radius: 8px; background: white; }

        .editable-area:focus { outline: 2px solid #3b82f6; border-color: transparent; }

        .editable-area img { max-width: 100%; height: auto; margin-top: 10px; border-radius: 4px; }

        ::-webkit-scrollbar { width: 6px; }

        ::-webkit-scrollbar-thumb { background: #4b5563; border-radius: 10px; }
</style>
</head>
<body class="bg-gray-50 flex h-screen overflow-hidden text-gray-800 font-sans">
<main class="flex-1 flex flex-col overflow-hidden">
<header class="bg-white border-b px-8 py-4 flex justify-between items-center shadow-sm">
<div class="flex items-center space-x-4">
<input type="date" id="datePicker" onchange="changeDate(this.value)" class="text-xl font-bold text-gray-700 bg-gray-100 p-2 rounded-lg outline-none border border-transparent focus:border-blue-500">
<span class="text-gray-400">Meeting Record</span>
</div>
<div class="space-x-2">
<button onclick="saveCurrentData()" class="bg-emerald-600 hover:bg-emerald-700 text-white px-5 py-2 rounded-lg text-sm transition">Save Changes</button>
<button onclick="exportToMail()" class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2 rounded-lg text-sm transition font-medium">Export to Email</button>
</div>
</header>
<div class="flex-1 overflow-y-auto p-8">
<div class="max-w-4xl mx-auto space-y-8">
<section>
<h2 class="text-sm font-bold text-blue-500 uppercase tracking-widest mb-3 italic">1. Agenda & Notes (Paste images allowed)</h2>
<div id="agendaContent" contenteditable="true" class="editable-area shadow-inner" placeholder="Enter agenda or paste screenshots here..."></div>
</section>
<section>
<h2 class="text-sm font-bold text-orange-500 uppercase tracking-widest mb-3 italic">2. Action Items (Unfinished Items Carried Over)</h2>
<div class="bg-white shadow rounded-lg overflow-hidden border">
<table class="w-full text-left">
<thead class="bg-gray-50 border-b">
<tr>
<th class="p-3 text-xs font-semibold text-gray-500">Task Description</th>
<th class="p-3 text-xs font-semibold text-gray-500 w-40">Due Date</th>
<th class="p-3 text-xs font-semibold text-gray-500 w-32">Owner</th>
<th class="p-3 text-xs font-semibold text-gray-500 w-28">Status</th>
<th class="p-3 text-xs font-semibold text-gray-500 w-16 text-center">Action</th>
</tr>
</thead>
<tbody id="actionTableBody"></tbody>
</table>
<div class="p-3 bg-gray-50 border-t">
<button onclick="addRow()" class="text-sm text-blue-600 hover:text-blue-800 font-medium">+ Add New Item</button>
</div>
</div>
</section>
</div>
</div>
</main>
<aside class="w-72 bg-slate-900 text-slate-300 flex flex-col shadow-2xl">
<div class="p-6">
<h2 class="text-white text-lg font-bold mb-4">Meeting Archive</h2>
<button onclick="createNewDay()" class="w-full bg-blue-600 hover:bg-blue-500 text-white py-3 rounded-xl font-bold transition shadow-lg mb-6">

                + New Meeting Page
</button>
<div id="historyNav" class="space-y-4">
</div>
</div>
</aside>
<script>

        let currentKey = ""; 

        window.onload = () => {

            const today = new Date().toISOString().split('T')[0];

            loadDay(today);

            renderHistoryNav();

        };

        function changeDate(newDate) {

            if(confirm("Switch to this date? Make sure you saved current changes.")) {

                loadDay(newDate);

            }

        }

        function loadDay(dateStr) {

            currentKey = dateStr;

            document.getElementById('datePicker').value = dateStr;

            const savedData = JSON.parse(localStorage.getItem(`meeting_${dateStr}`)) || { agenda: "", actions: [] };

            document.getElementById('agendaContent').innerHTML = savedData.agenda;

            const tbody = document.getElementById('actionTableBody');

            tbody.innerHTML = "";

            let displayActions = savedData.actions;

            // Requirement 5: Inherit all records from previous sessions if current is empty

            if (displayActions.length === 0) {

                displayActions = getAllActions(); 

            }

            displayActions.forEach(item => addRow(item.content, item.date, item.owner, item.status));

            if (displayActions.length === 0) addRow();

        }

        // Logic to grab all actions from historical data

        function getAllActions() {

            let allItems = [];

            const keys = Object.keys(localStorage).filter(k => k.startsWith('meeting_')).sort();

            keys.forEach(key => {

                const data = JSON.parse(localStorage.getItem(key));

                // Only carry over Pending items to the new page

                const pending = data.actions.filter(a => a.status === 'Pending');

                allItems.push(...pending);

            });

            // Remove duplicates based on content

            return Array.from(new Map(allItems.map(item => [item.content, item])).values());

        }

        function addRow(content = '', date = '', owner = '', status = 'Pending') {

            const tbody = document.getElementById('actionTableBody');

            const tr = document.createElement('tr');

            tr.className = "border-b last:border-0 hover:bg-gray-50 transition group";

            tr.innerHTML = `
<td class="p-2"><input type="text" value="${content}" class="w-full bg-transparent outline-none px-2 py-1"></td>
<td class="p-2"><input type="date" value="${date}" class="w-full bg-transparent outline-none px-2 py-1 text-sm"></td>
<td class="p-2"><input type="text" value="${owner}" class="w-full bg-transparent outline-none px-2 py-1 text-sm"></td>
<td class="p-2">
<select onchange="saveCurrentData()" class="w-full bg-transparent outline-none text-sm font-medium ${status === 'Done' ? 'text-green-600' : 'text-orange-600'}">
<option value="Pending" ${status === 'Pending' ? 'selected' : ''}>Pending</option>
<option value="Done" ${status === 'Done' ? 'selected' : ''}>Done</option>
</select>
</td>
<td class="p-2 text-center">
<button onclick="this.closest('tr').remove(); saveCurrentData();" class="text-gray-300 hover:text-red-500 transition opacity-0 group-hover:opacity-100">

                        ✕
</button>
</td>

            `;

            tbody.appendChild(tr);

        }

        function saveCurrentData() {

            const agenda = document.getElementById('agendaContent').innerHTML;

            const actionRows = Array.from(document.querySelectorAll('#actionTableBody tr'));

            const actions = actionRows.map(row => {

                const inputs = row.querySelectorAll('input, select');

                return {

                    content: inputs[0].value,

                    date: inputs[1].value,

                    owner: inputs[2].value,

                    status: inputs[3].value

                };

            }).filter(item => item.content.trim() !== "");

            const dataToSave = { agenda, actions };

            localStorage.setItem(`meeting_${currentKey}`, JSON.stringify(dataToSave));

            renderHistoryNav();

        }

        function renderHistoryNav() {

            const nav = document.getElementById('historyNav');

            nav.innerHTML = "";

            const keys = Object.keys(localStorage).filter(k => k.startsWith('meeting_')).map(k => k.replace('meeting_', '')).sort().reverse();

            const structure = {};

            keys.forEach(k => {

                const [y, m, d] = k.split('-');

                if (!structure[y]) structure[y] = {};

                if (!structure[y][m]) structure[y][m] = [];

                structure[y][m].push(k);

            });

            for (const y in structure) {

                let yHtml = `<details open class="group"><summary class="cursor-pointer font-bold text-slate-400 group-hover:text-white transition">${y}</summary><div class="ml-4 mt-2 space-y-2">`;

                for (const m in structure[y]) {

                    yHtml += `<details open><summary class="cursor-pointer text-sm font-semibold text-slate-500">Month ${m}</summary><div class="ml-2 border-l border-slate-700 my-1 font-light text-xs">`;

                    structure[y][m].forEach(date => {

                        yHtml += `<div onclick="loadDay('${date}')" class="pl-3 py-1 hover:bg-slate-800 cursor-pointer rounded ${date === currentKey ? 'text-blue-400 font-bold' : ''}">${date}</div>`;

                    });

                    yHtml += `</div></details>`;

                }

                yHtml += `</div></details>`;

                nav.innerHTML += yHtml;

            }

        }

        function createNewDay() {

            const date = prompt("Enter meeting date (YYYY-MM-DD):", new Date().toISOString().split('T')[0]);

            if (date) loadDay(date);

        }

        function exportToMail() {

            const agenda = document.getElementById('agendaContent').innerText;

            const actionRows = Array.from(document.querySelectorAll('#actionTableBody tr'));

            let actionText = "【ACTION ITEMS】\n";

            actionRows.forEach(row => {

                const inputs = row.querySelectorAll('input, select');

                if(inputs[0].value && inputs[3].value !== 'Done') {

                    actionText += `• [${inputs[2].value || 'N/A'}] ${inputs[0].value} (Due: ${inputs[1].value || 'TBD'})\n`;

                }

            });

            const fullText = `Meeting Date: ${currentKey}\n\n【AGENDA】\n${agenda}\n\n${actionText}`;

            navigator.clipboard.writeText(fullText).then(() => alert('Copied to clipboard in Email format!'));

        }
</script>
</body>
</html>
 
